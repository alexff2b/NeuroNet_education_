<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="ia_network_8cpp" kind="file" language="C++">
    <compoundname>iaNetwork.cpp</compoundname>
    <includes refid="ia_network_8h" local="yes">iaNetwork.h</includes>
    <incdepgraph>
      <node id="5">
        <label>iaVector.h</label>
        <link refid="ia_vector_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>iaNetwork.h</label>
        <link refid="ia_network_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>random</label>
      </node>
      <node id="3">
        <label>iostream</label>
      </node>
      <node id="6">
        <label>iaMatrix.h</label>
        <link refid="ia_matrix_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>C:/Users/aleksandri/Documents/GitHub/NeuroNet_education_/iaNetwork.cpp</label>
        <link refid="ia_network_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ia_network_8h" kindref="compound">iaNetwork.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5" refid="classia_network_1a11d94ca89a6bf4e92696cde2899f80fb" refkind="member"><highlight class="normal"><ref refid="classia_network_1a11d94ca89a6bf4e92696cde2899f80fb" kindref="member">iaNetwork::iaNetwork</ref>()<sp/>:<sp/><ref refid="classia_network" kindref="compound">iaNetwork</ref>(0)<sp/>{</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight></codeline>
<codeline lineno="9" refid="classia_network_1adbf695ade31b10e572676924d6360ed8" refkind="member"><highlight class="normal"><ref refid="classia_network_1a11d94ca89a6bf4e92696cde2899f80fb" kindref="member">iaNetwork::iaNetwork</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>layersCount)<sp/>{</highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>=<sp/>layersCount<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref><sp/>=<sp/>(this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>!=<sp/>0<sp/>?<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classia_matrix" kindref="compound">iaMatrix</ref>[this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>]()<sp/>:<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref><sp/>=<sp/>(this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>!=<sp/>0<sp/>?<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="structia_network_1_1ia_layer" kindref="compound">iaLayer</ref>[this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>]()<sp/>:<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);<sp/></highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref><sp/>=<sp/>(this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>!=<sp/>0<sp/>?<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classia_vector" kindref="compound">iaVector</ref>[this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>]()<sp/>:<sp/></highlight><highlight class="keyword">nullptr</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="14"><highlight class="normal">}</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="classia_network_1a0684bcd9d328e7b9519f10a0775f399c" refkind="member"><highlight class="normal"><ref refid="classia_network_1a11d94ca89a6bf4e92696cde2899f80fb" kindref="member">iaNetwork::iaNetwork</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>layersCount,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sizes[])<sp/>:<sp/><ref refid="classia_network" kindref="compound">iaNetwork</ref>(layersCount)<sp/>{</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/>random_device<sp/>randomGenerator;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/>normal_distribution&lt;double&gt;<sp/>dist(-0.5,<sp/>0.5);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>1;<sp/>l<sp/>&lt;<sp/>layersCount;<sp/>l++)<sp/>{</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x_size<sp/>=<sp/>sizes[l];</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y_size<sp/>=<sp/>sizes[l<sp/>-<sp/>1];</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>matrixSize<sp/>=<sp/>x_size<sp/>*<sp/>y_size;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*randomNumbers<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">[matrixSize]();</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>sizes[l];<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>sizes[l<sp/>-<sp/>1];<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index<sp/>=<sp/>i<sp/>*<sp/>sizes[l<sp/>-<sp/>1]<sp/>+<sp/>j;</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>randomNumbers[index]<sp/>=<sp/>dist(randomGenerator);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l<sp/>-<sp/>1]<sp/>=<sp/><ref refid="classia_matrix" kindref="compound">iaMatrix</ref>(sizes[l],<sp/>sizes[l<sp/>-<sp/>1],<sp/>randomNumbers);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a310466db01d0e22406c4b63b95f70e99" kindref="member">x</ref><sp/>=<sp/><ref refid="classia_vector" kindref="compound">iaVector</ref>(sizes[l<sp/>-<sp/>1]);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Создание<sp/>вектора<sp/>для<sp/>входа<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref><sp/>=<sp/><ref refid="classia_vector" kindref="compound">iaVector</ref>(sizes[l]);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Создание<sp/>вектора<sp/>для<sp/>выхода<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref><sp/>=<sp/><ref refid="classia_vector" kindref="compound">iaVector</ref>(sizes[l]);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Создание<sp/>вектора<sp/>для<sp/>производной<sp/>активации<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l<sp/>-<sp/>1]<sp/>=<sp/><ref refid="classia_vector" kindref="compound">iaVector</ref>(sizes[l]);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Создание<sp/>вектора<sp/>для<sp/>дельт<sp/>ошибок<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">[]<sp/>randomNumbers;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="42"><highlight class="normal">}</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44" refid="classia_network_1a078f93da3cca25c0407075a47afc639e" refkind="member"><highlight class="normal"><ref refid="classia_network_1a11d94ca89a6bf4e92696cde2899f80fb" kindref="member">iaNetwork::iaNetwork</ref>(<ref refid="structnet_setings" kindref="compound">netSetings</ref><sp/>setings)<sp/>:<sp/><ref refid="classia_network" kindref="compound">iaNetwork</ref>(setings.numberOfLayers,<sp/>setings.sizes)<sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal">}</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48" refid="classia_network_1a910724de76aa40461b3de8dd6bb8dc4e" refkind="member"><highlight class="normal"><ref refid="classia_network_1a910724de76aa40461b3de8dd6bb8dc4e" kindref="member">iaNetwork::~iaNetwork</ref>()<sp/>{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal">}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="classia_network_1a04287239300c639035ccd36178feeaad" refkind="member"><highlight class="normal"><ref refid="classia_vector" kindref="compound">iaVector</ref><sp/><ref refid="classia_network_1a04287239300c639035ccd36178feeaad" kindref="member">iaNetwork::ForwardPropogation</ref>(<ref refid="classia_vector" kindref="compound">iaVector</ref><sp/>inputVector,<sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592" kindref="member">activation</ref><sp/>foncActiv)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Получение<sp/>выхода<sp/>сети<sp/>(прямое<sp/>распространение)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>;<sp/>l++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>слоев</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l<sp/>==<sp/>0)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Если<sp/>активный<sp/>слой<sp/>нулевой</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>inputVector.<ref refid="classia_vector_1a82d20ecd1daa52dc1641bef8a39f84a9" kindref="member">sizeOfVector</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a310466db01d0e22406c4b63b95f70e99" kindref="member">x</ref>[i]<sp/>=<sp/>inputVector[i];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Получить<sp/>входные<sp/>сигналы</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>иначе<sp/>если<sp/>это<sp/>внутренный<sp/>или<sp/>выходной<sp/>слои</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>.<ref refid="classia_vector_1a82d20ecd1daa52dc1641bef8a39f84a9" kindref="member">sizeOfVector</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a310466db01d0e22406c4b63b95f70e99" kindref="member">x</ref>[i]<sp/>=<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Получить<sp/>входные<sp/>сигналы<sp/>от<sp/>предыдущего<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a660da4bfc4021cc0770fcc11da9d972e" kindref="member">numberOfVectors</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Выход<sp/>функции<sp/>активации<sp/>нейрона</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a1ce3049b06370bd3fc1dcc0d512d592f" kindref="member">sizeOfVectors</ref>();<sp/>j++)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>входов<sp/>в<sp/>нейрон</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>+=<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l][i][j]<sp/>*<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].x[j];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Подсчет<sp/>взвешенной<sp/>суммы<sp/>входных<sp/>сигналов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(foncActiv)<sp/>{</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592a3f9486d01e74209984645c9f5f8e3271" kindref="member">Hyperbolic_Tangent</ref>:<sp/>{</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>tan(y);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Активация<sp/>функции<sp/>гиперболическим<sp/>тангенсом<sp/>(-1,<sp/>1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>1<sp/>-<sp/>pow(this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].z[i],<sp/>2);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>*this-&gt;layers[l].z[i];<sp/><sp/><sp/><sp/>//<sp/>Производная<sp/>гиперболического<sp/>тангенса</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592ab77f370239b7574a3692c561c52fa9e6" kindref="member">Arctangent</ref>:<sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>atan(y);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>1<sp/>/<sp/>(y<sp/>*<sp/>y<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592a84928249b44745e58420845215c1c4df" kindref="member">Sigmoid</ref>:<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>1<sp/>/<sp/>(1<sp/>+<sp/>exp(-y));<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Активация<sp/>функции<sp/>сигмойдной<sp/>функцией<sp/>(0,<sp/>1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/><ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>*<sp/>(-<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]);<sp/></highlight><highlight class="comment">//<sp/>Производная<sp/>сигмойдной<sp/>функции</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592a54a1ea1b0aefb67a9be66d7bcf3d53a7" kindref="member">ReLu</ref>:<sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>y<sp/>&gt;<sp/>0<sp/>?<sp/>y<sp/>:<sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Активация<sp/>функции<sp/>ReLU<sp/>[0,<sp/>y)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>y<sp/>&gt;<sp/>0<sp/>?<sp/>1<sp/>:<sp/>0;<sp/><sp/></highlight><highlight class="comment">//<sp/>Производная<sp/>функции<sp/>ReLU</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592ab3784b2f47eb353064834d258dc91d76" kindref="member">Gaussian</ref>:<sp/>{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>exp(-y<sp/>*<sp/>y);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Активация<sp/>функции<sp/>Гаусса<sp/>(0,<sp/>1]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>-2<sp/>*<sp/>y<sp/>*<sp/>exp(-y<sp/>*<sp/>y);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Производная<sp/>функции<sp/>Гаусса</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592aa810982671b7fe910f9b073394fdefcd" kindref="member">Sin</ref>:<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>sin(y);</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>cos(y);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592a860db4f245c33e84faf1d955305c14e7" kindref="member">Sinc</ref>:<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>(y<sp/>==<sp/>0<sp/>?<sp/>1<sp/>:<sp/>sin(y)<sp/>/<sp/>y);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>(y<sp/>==<sp/>0<sp/>?<sp/>0<sp/>:<sp/>cos(y)<sp/>/<sp/>y<sp/>-<sp/>sin(y)<sp/>/<sp/>y);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/>{<sp/></highlight><highlight class="comment">//<sp/>Identity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i]<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/>}</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>Возврат<sp/>результата</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal">}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="classia_network_1a634697f9880299b612e809d14b1b0eea" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a634697f9880299b612e809d14b1b0eea" kindref="member">iaNetwork::BackwardPropogation</ref>(<ref refid="classia_vector" kindref="compound">iaVector</ref><sp/>outputVector,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>error)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Подготовка<sp/>к<sp/>обновлению<sp/>весовых<sp/>коэффициентов<sp/>(обратное<sp/>распространение)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/>*error<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Сброс<sp/>величины<sp/>ошибки<sp/>в<sp/>ноль</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>last<sp/>=<sp/>this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref><sp/>-<sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Установка<sp/>предыдущего<sp/>перед<sp/>последним<sp/>слоя</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>outputVector.<ref refid="classia_vector_1a82d20ecd1daa52dc1641bef8a39f84a9" kindref="member">sizeOfVector</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>err<sp/>=<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[last].<ref refid="structia_network_1_1ia_layer_1a338a6d8cb5fbbaf6b3c93503bd19833e" kindref="member">z</ref>[i]<sp/>-<sp/>outputVector[i];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Вычисление<sp/>ошибки</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[last][i]<sp/>=<sp/>err<sp/>*<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[last].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[i];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Вычисление<sp/>дельты</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*error<sp/>=<sp/>err<sp/>*<sp/>err<sp/>/<sp/>2;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Подсчет<sp/>величины<sp/>ошибки<sp/>(среднеквадратичное<sp/>отклонение)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>last;<sp/>l<sp/>&gt;<sp/>0;<sp/>l--)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обратный<sp/>перебор<sp/>слоев</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a1ce3049b06370bd3fc1dcc0d512d592f" kindref="member">sizeOfVectors</ref>();<sp/>j++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебо<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l<sp/>-<sp/>1][j]<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Сброс<sp/>дельты</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a660da4bfc4021cc0770fcc11da9d972e" kindref="member">numberOfVectors</ref>();<sp/>i++)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>входов<sp/>в<sp/>нейрон</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l<sp/>-<sp/>1][j]<sp/>+=<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l][i][j]<sp/>*<sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l][i];<sp/><sp/></highlight><highlight class="comment">//<sp/>Коррекция<sp/>дельты</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l<sp/>-<sp/>1][j]<sp/>*=<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l<sp/>-<sp/>1].<ref refid="structia_network_1_1ia_layer_1a2aae1c81923041458bdd7d8dbe668108" kindref="member">fD</ref>[j];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Коррекция<sp/>последней<sp/>дельты</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal">}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="classia_network_1a420e5b50a78381732682bb0187ed8c32" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a420e5b50a78381732682bb0187ed8c32" kindref="member">iaNetwork::UpdateWeights</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alpha)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обновление<sp/>весовых<sp/>коэффициентов<sp/>(alpha<sp/>-<sp/>скорость<sp/>обучения)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>;<sp/>l++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>слоев</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a660da4bfc4021cc0770fcc11da9d972e" kindref="member">numberOfVectors</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a1ce3049b06370bd3fc1dcc0d512d592f" kindref="member">sizeOfVectors</ref>();<sp/>j++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>входов<sp/>в<sp/>нейрон</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l][i][j]<sp/>-=<sp/>alpha<sp/>*<sp/>this-&gt;<ref refid="classia_network_1a940cb46a6064b4684d7f80b81a6acf92" kindref="member">deltas</ref>[l][i]<sp/>*<sp/>this-&gt;<ref refid="classia_network_1a24897f9a555a7f10eecb79d610a99bf1" kindref="member">layers</ref>[l].<ref refid="structia_network_1_1ia_layer_1a310466db01d0e22406c4b63b95f70e99" kindref="member">x</ref>[j];<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обновление<sp/>весового<sp/>коэффициента</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal">}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136" refid="classia_network_1a411665c95fe0be2fa526c30eb90462ef" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a411665c95fe0be2fa526c30eb90462ef" kindref="member">iaNetwork::Train</ref>(<ref refid="classia_matrix" kindref="compound">iaMatrix</ref><sp/>X,<sp/><ref refid="classia_matrix" kindref="compound">iaMatrix</ref><sp/>Y,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alpha,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eps,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>epochs)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>epoch<sp/>=<sp/>1;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Установить<sp/>номер<sp/>эпохи<sp/>первый</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>error;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ошибка<sp/>в<sp/>эпохе</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>error<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Сбросить<sp/>величину<sp/>ошибки</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>X.<ref refid="classia_matrix_1a660da4bfc4021cc0770fcc11da9d972e" kindref="member">numberOfVectors</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>элементов<sp/>обучающего<sp/>множества</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classia_network_1a04287239300c639035ccd36178feeaad" kindref="member">ForwardPropogation</ref>(X[i],<sp/><ref refid="classia_network_1a81f89da91c4331aff0a5388e81f61592ab3784b2f47eb353064834d258dc91d76" kindref="member">Gaussian</ref>);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Прямое<sp/>распространение<sp/>сигнала</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classia_network_1a634697f9880299b612e809d14b1b0eea" kindref="member">BackwardPropogation</ref>(Y[i],<sp/>&amp;error);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обратное<sp/>распространение<sp/>ошибки</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classia_network_1a420e5b50a78381732682bb0187ed8c32" kindref="member">UpdateWeights</ref>(alpha);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обновление<sp/>весовых<sp/>коэффициентов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Epoch:\t&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>epoch<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;\t\tError:\t&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>error<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>epoch++;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Увеличить<sp/>номер<sp/>эпохи</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(epoch<sp/>&lt;=<sp/>epochs<sp/>&amp;&amp;<sp/>error<sp/>&gt;<sp/>eps);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Выполнять<sp/>пока<sp/>не<sp/>закончатся<sp/>эпохи<sp/>или<sp/>ошибка<sp/>не<sp/>достигнет<sp/>допостимого<sp/>значенияx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal">}</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151" refid="classia_network_1a2d3e0614d5a2ddaa095d1c91c4ae4042" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classia_network_1a2d3e0614d5a2ddaa095d1c91c4ae4042" kindref="member">iaNetwork::InitWeigths</ref>(<ref refid="classia_matrix" kindref="compound">iaMatrix</ref><sp/>newWeights)<sp/>{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac74fb9841f29cd367bd13fb66fcfb081" kindref="member">layersNumber</ref>;<sp/>l++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>слоев</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a660da4bfc4021cc0770fcc11da9d972e" kindref="member">numberOfVectors</ref>();<sp/>i++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>нейронов</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l].<ref refid="classia_matrix_1a1ce3049b06370bd3fc1dcc0d512d592f" kindref="member">sizeOfVectors</ref>();<sp/>j++)<sp/>{<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Перебор<sp/>входов<sp/>в<sp/>нейрон</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this-&gt;<ref refid="classia_network_1ac18ca359ad1c64561ac28db11c8b3fb6" kindref="member">weights</ref>[l][i][j]<sp/>=<sp/>newWeights[l][j];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Обновление<sp/>весового<sp/>коэффициента</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="159"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/Users/aleksandri/Documents/GitHub/NeuroNet_education_/iaNetwork.cpp"/>
  </compounddef>
</doxygen>
